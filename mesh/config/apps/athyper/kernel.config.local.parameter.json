{
  "$schema": "./kernel.config.schema.json",
  "$comment": "Local Development — works on Windows, macOS, and Linux. Provides IAM realm config, feature flags, and tenant defaults. Infrastructure wiring (db, redis, s3, telemetry endpoints) is LOCKED from this file and must be set via env vars in the root .env file.",

  "env": "local",
  "mode": "api",
  "serviceName": "athyper-runtime",
  "port": 3000,

  "logLevel": "debug",
  "shutdownTimeoutMs": 15000,

  "publicBaseUrl": "https://api.athyper.local",
  "publicWebUrl": "https://neon.athyper.local",

  "db": {
    "$comment": "LOCKED — stripped at load time. Actual values come from DATABASE_URL / DATABASE_ADMIN_URL env vars. Local MESH exposes PgBouncer on localhost:6432.",
    "url": "LOCKED_USE_ENV_VAR",
    "adminUrl": "LOCKED_USE_ENV_VAR",
    "poolMax": 5
  },

  "redis": {
    "$comment": "LOCKED — stripped at load time. Actual value comes from REDIS_URL env var. Local MESH exposes Redis on localhost:6379.",
    "url": "LOCKED_USE_ENV_VAR"
  },

  "s3": {
    "$comment": "LOCKED — stripped at load time. Actual values come from S3_* env vars. Local MESH provides MinIO via Traefik at https://objectstorage.mesh.athyper.local.",
    "endpoint": "LOCKED_USE_ENV_VAR",
    "accessKey": "LOCKED_USE_ENV_VAR",
    "secretKey": "LOCKED_USE_ENV_VAR",
    "region": "us-east-1",
    "bucket": "athyper-local",
    "useSSL": false
  },

  "iam": {
    "strategy": "single_realm",
    "defaultRealmKey": "athyper",
    "defaultTenantKey": "default",
    "defaultOrgKey": null,
    "requireTenantClaimsInProd": false,
    "realms": {
      "athyper": {
        "iam": {
          "issuerUrl": "https://iam.mesh.athyper.local/realms/athyper",
          "clientId": "athyper-api",
          "clientSecretRef": "IAM_ATHYPER_CLIENT_SECRET"
        },
        "defaults": {
          "features": {
            "metaStudio": true,
            "debugMode": true
          },
          "policies": {
            "strictTenantIsolation": false
          }
        },
        "tenants": {
          "default": {
            "defaults": {
              "country": "US",
              "currency": "USD",
              "timezone": "UTC"
            },
            "orgs": {}
          }
        }
      }
    }
  },

  "telemetry": {
    "$comment": "LOCKED — otlpEndpoint and enabled are stripped at load time. Set via env vars.",
    "enabled": true,
    "otlpEndpoint": "LOCKED_USE_ENV_VAR",
    "serviceName": "athyper-runtime",
    "serviceVersion": "1.0.0"
  }
}
