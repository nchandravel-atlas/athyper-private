{
  "$schema": "./kernel.config.schema.json",
  "$comment": "Staging Environment (Ubuntu) — pre-production testing. Infrastructure wiring (db, redis, s3, telemetry endpoints) is LOCKED from this file and must be set via SUPERSTAR env vars or staging .env.",

  "env": "staging",
  "mode": "api",
  "serviceName": "athyper-runtime",
  "port": 3000,

  "logLevel": "info",
  "shutdownTimeoutMs": 30000,

  "publicBaseUrl": "https://api-stg.athyper.com",
  "publicWebUrl": "https://neon-stg.athyper.com",

  "db": {
    "$comment": "LOCKED — stripped at load time. Set DATABASE_URL / DATABASE_ADMIN_URL via staging .env or SUPERSTAR env vars.",
    "url": "LOCKED_USE_ENV_VAR",
    "adminUrl": "LOCKED_USE_ENV_VAR",
    "poolMax": 20
  },

  "redis": {
    "$comment": "LOCKED — stripped at load time. Set REDIS_URL via staging .env or SUPERSTAR env vars.",
    "url": "LOCKED_USE_ENV_VAR"
  },

  "s3": {
    "$comment": "LOCKED — stripped at load time. Set S3_* via staging .env or SUPERSTAR env vars.",
    "endpoint": "LOCKED_USE_ENV_VAR",
    "accessKey": "LOCKED_USE_ENV_VAR",
    "secretKey": "LOCKED_USE_ENV_VAR",
    "region": "us-east-1",
    "bucket": "athyper-staging",
    "useSSL": true
  },

  "iam": {
    "strategy": "single_realm",
    "defaultRealmKey": "athyper",
    "defaultTenantKey": null,
    "defaultOrgKey": null,
    "requireTenantClaimsInProd": false,
    "realms": {
      "athyper": {
        "iam": {
          "issuerUrl": "https://iam.mesh-stg.athyper.com/realms/athyper",
          "clientId": "athyper-api-runtime",
          "allowedAzp": ["neon-web", "neon-svc-bff", "athyper-svc-runtime-worker"],
          "clientSecretRef": "IAM_ATHYPER_CLIENT_SECRET"
        },
        "defaults": {
          "features": {
            "metaStudio": true,
            "debugMode": false
          },
          "policies": {
            "strictTenantIsolation": true
          }
        },
        "tenants": {}
      }
    }
  },

  "telemetry": {
    "$comment": "LOCKED — otlpEndpoint and enabled are stripped at load time. Set via staging .env or SUPERSTAR env vars.",
    "enabled": true,
    "otlpEndpoint": "LOCKED_USE_ENV_VAR",
    "serviceName": "athyper-runtime",
    "serviceVersion": "1.0.0"
  }
}
