{
  "$schema": "./kernel.config.schema.json",
  "$comment": "Staging Environment - pre-production testing",

  "env": "staging",
  "mode": "api",
  "serviceName": "athyper-runtime",
  "port": 3000,

  "logLevel": "info",
  "shutdownTimeoutMs": 30000,

  "publicBaseUrl": "https://api-stg.athyper.com",
  "publicWebUrl": "https://neon-stg.athyper.com",

  "db": {
    "url": "${DATABASE_URL}",
    "adminUrl": "${DATABASE_ADMIN_URL}",
    "poolMax": 20
  },

  "redis": {
    "url": "${REDIS_URL}"
  },

  "s3": {
    "endpoint": "${S3_ENDPOINT}",
    "accessKey": "${S3_ACCESS_KEY}",
    "secretKey": "${S3_SECRET_KEY}",
    "region": "${S3_REGION}",
    "bucket": "${S3_BUCKET}",
    "useSSL": true
  },

  "iam": {
    "strategy": "single_realm",
    "defaultRealmKey": "athyper",
    "defaultTenantKey": null,
    "defaultOrgKey": null,
    "requireTenantClaimsInProd": false,
    "realms": {
      "athyper": {
        "iam": {
          "issuerUrl": "${IAM_ISSUER_URL}",
          "clientId": "${IAM_CLIENT_ID}",
          "clientSecretRef": "IAM_ATHYPER_CLIENT_SECRET"
        },
        "defaults": {
          "features": {
            "metaStudio": true,
            "debugMode": false
          },
          "policies": {
            "strictTenantIsolation": true
          }
        },
        "tenants": {}
      }
    }
  },

  "telemetry": {
    "enabled": true,
    "otlpEndpoint": "${OTLP_ENDPOINT}",
    "serviceName": "athyper-runtime",
    "serviceVersion": "${SERVICE_VERSION}"
  }
}
