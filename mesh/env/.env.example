# =============================================
# PROJECT NAME
# =============================================
COMPOSE_PROJECT_NAME=athyper-mesh
# =============================================
# GENERAL
# =============================================
ENVIRONMENT=localdev
ATHYPER_KERNEL_CONFIG_PATH=apps/athyper/kernel.config.local.parameter.json
MESH_DATA=D:/Development/athyper/mesh/data
MESH_CONFIG=D:/Development/athyper/mesh/config
# =============================================
# Mesh Dynamic TLS and Auth config references
# =============================================
MESH_TLS_OPTIONS=mesh-gateway-tls12@file
MESH_DASHBOARD_AUTH_MW=mesh-dashboard-auth@file
# =============================================
# Mesh Hostnames / Domains
# =============================================
MESH_GATEWAY_HOST=mesh.gateway.local
MESH_IAM_HOST=mesh.iam.local
MESH_OBJECTSTORAGE_HOST=mesh.objectstorage.local
MESH_OBJECTSTORAGE_CONSOLE_HOST=mesh.objectstorage.console.local
MESH_TELEMETRY_HOST=mesh.telemetry.local
MESH_METRICS_HOST=mesh.metrics.local
MESH_TRACES_HOST=mesh.traces.local
MESH_LOGS_HOST=mesh.logs.local
APPS_ATHYPER_WEB_HOST=athyper.local
APPS_ATHYPER_API_HOST=athyper.api.local
# =============================================
# Mesh Service Memory Limit (Env specific)
# =============================================
MESH_GATEWAY_MEMORY_LIMIT=128m
MESH_IAM_MEMORY_LIMIT=768m
MESH_OBJECTSTORAGE_MEMORY_LIMIT=256m
MESH_MEMORYCACHE_MEMORY_LIMIT=128m
MESH_MEMORYCACHE_EXPORTER_MEMORY_LIMIT=64m
MESH_TELEMETRY_MEMORY_LIMIT=256m
MESH_METRICS_MEMORY_LIMIT=384m
MESH_TRACING_MEMORY_LIMIT=256m
MESH_LOGGING_MEMORY_LIMIT=384m
MESH_LOGSHIPPER_MEMORY_LIMIT=64m
APPS_ATHYPER_MEMORY_LIMIT=32m
# =============================================
# Mesh gateway
# =============================================
MESH_GATEWAY_ACCESSLOG=true
MESH_GATEWAY_LOG_LEVEL=INFO
# =============================================
# Mesh IAM
# =============================================
MESH_IAM_ADMIN=athyperadmin
MESH_IAM_ADMIN_PASSWORD=athyperadmin
MESH_IAM_DB_URL=jdbc:postgresql://mesh.dbpool.atlasdigitaltech.com:6433/athyperauth_dev1?preferQueryMode=simple
MESH_IAM_DB_USERNAME=athyperauthdb_user
MESH_IAM_DB_PASSWORD=athyperadmin
# =============================================
# Object Storage
# =============================================
MESH_OBJECTSTORAGE_ADMIN=athyperadmin
MESH_OBJECTSTORAGE_ADMIN_PASSWORD=athyperadmin
# =============================================
# Cache
# =============================================
MESH_MEMORYCACHE_PASSWORD=athyperadmin
# =============================================
# Observability (Telemetry)
# =============================================
MESH_TELEMETRY_SECURITY_ADMIN_USER=athyperadmin
MESH_TELEMETRY_SECURITY_ADMIN_PASSWORD=athyperadmin

# =============================================
# Athyper Runtime - Adapter Configuration
# =============================================

# Environment mode
NODE_ENV=production
RUNTIME_ENV=production

# Runtime configuration
RUNTIME_MODE=api
RUNTIME_PORT=3000
SERVICE_NAME=athyper-api

# Logging
LOG_LEVEL=info

# =============================================
# Database Adapter Configuration
# =============================================

# PgBouncer connection (transaction mode for tenant isolation)
DATABASE_URL=postgresql://athyper:password@pgbouncer.local:6432/athyper

# Optional: Direct Postgres connection for migrations
DATABASE_ADMIN_URL=postgresql://postgres:admin-password@postgres.local:5432/athyper

# Connection pool size
DATABASE_POOL_MAX=25

# =============================================
# Keycloak / IAM Adapter Configuration
# =============================================

# Keycloak realm issuer URL
KEYCLOAK_ISSUER_URL=https://keycloak.example.com/realms/main

# OAuth2/OIDC client credentials
KEYCLOAK_CLIENT_ID=athyper-api
KEYCLOAK_CLIENT_SECRET=your-client-secret-here

# =============================================
# Redis Configuration
# =============================================

# Redis URL for caching, sessions, job queues
REDIS_URL=redis://redis.local:6379/0

# =============================================
# S3 / Object Storage Configuration
# =============================================

S3_ENDPOINT=https://s3.amazonaws.com
S3_ACCESS_KEY_ID=your-access-key
S3_SECRET_ACCESS_KEY=your-secret-key
S3_REGION=us-east-1
S3_BUCKET=athyper-storage
S3_USE_SSL=true

# =============================================
# Telemetry Adapter / Observability
# =============================================

# OpenTelemetry configuration
OTEL_ENABLED=true
OTEL_EXPORTER_OTLP_ENDPOINT=http://jaeger.local:4318
OTEL_SERVICE_NAME=athyper-api
OTEL_ENVIRONMENT=production

# Trace sampling (0.0 to 1.0; use 0.1 for 10% sampling in production)
OTEL_TRACES_SAMPLER=traceidratio
OTEL_TRACES_SAMPLER_ARG=0.1

# =============================================
# Multi-Tenancy / IAM Strategy
# =============================================

# IAM strategy: single_realm or multi_realm
IAM_STRATEGY=single_realm

# Default realm (if not provided in headers/claims)
IAM_DEFAULT_REALM_KEY=main

# Default tenant (for single-tenant deployments)
IAM_DEFAULT_TENANT_KEY=default

# Default org (if applicable)
IAM_DEFAULT_ORG_KEY=default

# Require tenant claims in production
IAM_REQUIRE_TENANT_CLAIMS_PROD=true

# =============================================
# Shutdown & Lifecycle
# =============================================

# Graceful shutdown timeout (milliseconds)
SHUTDOWN_TIMEOUT_MS=15000
