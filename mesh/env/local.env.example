# =============================================
# athyper MESH - Environment Configuration
# =============================================

# =============================================
# ENVIRONMENT IDENTITY
# =============================================
# Valid values: local | staging | production
ENVIRONMENT=local
COMPOSE_PROJECT_NAME=athyper-mesh

# =============================================
# RUNTIME CONFIGURATION
# =============================================
MODE=api
MULTITENANT=TRUE
SERVICE_NAME=athyper-runtime
SERVICE_VERSION=1.0.0
PORT=3000
LOG_LEVEL=debug
SHUTDOWN_TIMEOUT_MS=15000

# =============================================
# PUBLIC URLs
# =============================================
PUBLIC_BASE_URL=https://api.athyper.local
PUBLIC_WEB_URL=https://neon.athyper.local

# =============================================
# BASE PATHS
# =============================================
# Windows: Use forward slashes â€” Docker Compose handles them correctly.
#   MESH_DATA=C:/Users/you/athyper-private/mesh/data
#   MESH_CONFIG=C:/Users/you/athyper-private/mesh/config
# Linux/macOS:
#   MESH_DATA=/home/you/athyper-private/mesh/data
#   MESH_CONFIG=/home/you/athyper-private/mesh/config
MESH_DATA=./mesh/data
MESH_CONFIG=./mesh/config
ATHYPER_KERNEL_CONFIG_PATH=apps/athyper/kernel.config.local.parameter.json
AUTH_DEBUG_EXPOSE_TOKENS=true

# =============================================
# HOSTNAMES
# =============================================
# Gateway & Infrastructure
GATEWAY_HOST=gateway.mesh.athyper.local
IAM_HOST=iam.mesh.athyper.local
OBJECTSTORAGE_HOST=objectstorage.mesh.athyper.local
OBJECTSTORAGE_CONSOLE_HOST=objectstorage.console.mesh.athyper.local

# Observability
TELEMETRY_HOST=telemetry.mesh.athyper.local
METRICS_HOST=metrics.mesh.athyper.local
TRACES_HOST=traces.mesh.athyper.local
LOGS_HOST=logs.mesh.athyper.local

# Applications
APPS_ATHYPER_WEB_HOST=neon.athyper.local
APPS_ATHYPER_API_HOST=api.athyper.local

# =============================================
# GATEWAY (Traefik)
# =============================================
GATEWAY_TLS_OPTIONS=mesh-gateway-tls12@file
DASHBOARD_AUTH_MW=mesh-dashboard-auth@file
GATEWAY_ACCESSLOG=true
GATEWAY_LOG_LEVEL=DEBUG

# =============================================
# SERVICE MEMORY LIMITS
# =============================================
GATEWAY_MEMORY_LIMIT=128m
IAM_MEMORY_LIMIT=768m
OBJECTSTORAGE_MEMORY_LIMIT=256m
MEMORYCACHE_MEMORY_LIMIT=128m
MEMORYCACHE_EXPORTER_MEMORY_LIMIT=64m
TELEMETRY_MEMORY_LIMIT=256m
METRICS_MEMORY_LIMIT=384m
TRACING_MEMORY_LIMIT=256m
LOGGING_MEMORY_LIMIT=384m
LOGSHIPPER_MEMORY_LIMIT=64m
APPS_ATHYPER_MEMORY_LIMIT=256m
DB_MEMORY_LIMIT=512m
DBPOOL_APPS_MEMORY_LIMIT=64m
DBPOOL_AUTH_MEMORY_LIMIT=64m

# =============================================
# DATABASE (PostgreSQL via PgBouncer)
# =============================================
DB_ADMIN_PASSWORD=athyperadmin
DATABASE_URL=postgresql://athyperadmin:athyperadmin@dbpool-apps:6432/athyper_dev1
DATABASE_ADMIN_URL=postgresql://athyperadmin:athyperadmin@db:5432/athyper_dev1
DB_POOL_MAX=5

# =============================================
# CACHE (Redis)
# =============================================
REDIS_URL=redis://:athyperadmin@memorycache:6379/0
MEMORYCACHE_PASSWORD=athyperadmin

# =============================================
# OBJECT STORAGE (MinIO S3)
# S3_ACCESS_KEY/S3_SECRET_KEY are also used as
# MinIO root credentials in the objectstorage container
# =============================================
S3_ENDPOINT=http://objectstorage:9000
S3_ACCESS_KEY=athyperadmin
S3_SECRET_KEY=athyperadmin
S3_REGION=us-east-1
S3_BUCKET=athyper-local
S3_USE_SSL=false

# =============================================
# IAM (Keycloak)
# =============================================
IAM_ADMIN=athyperadmin
IAM_ADMIN_PASSWORD=athyperadmin
IAM_DB_URL=jdbc:postgresql://dbpool-auth:6433/athyperauth_dev1?preferQueryMode=simple
IAM_DB_USERNAME=athyperadmin
IAM_DB_PASSWORD=athyperadmin
IAM_ISSUER_URL=https://iam.mesh.athyper.local/realms/athyper
IAM_CLIENT_ID=athyper-api
IAM_CLIENT_SECRET=athyperadmin

# =============================================
# IAM SECRETS (SUPERSTAR env vars)
# =============================================
# These are resolved by kernel config loader
ATHYPER_SUPER__IAM_SECRET__IAM_ATHYPER_CLIENT_SECRET=athyperadmin

# =============================================
# TELEMETRY
# =============================================
OTLP_ENDPOINT=http://logshipper:4318
TELEMETRY_ADMIN_USER=athyperadmin
TELEMETRY_ADMIN_PASSWORD=athyperadmin
