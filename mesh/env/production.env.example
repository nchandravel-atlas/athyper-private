# =============================================
# athyper MESH - Environment Configuration
# =============================================

# =============================================
# ENVIRONMENT IDENTITY
# =============================================
# Valid values: local | staging | production
ENVIRONMENT=production
COMPOSE_PROJECT_NAME=athyper-mesh

# =============================================
# RUNTIME CONFIGURATION
# =============================================
MODE=api
MULTITENANT=TRUE
SERVICE_NAME=athyper-runtime
SERVICE_VERSION=${RELEASE_VERSION}
PORT=3000
LOG_LEVEL=warn
SHUTDOWN_TIMEOUT_MS=60000

# =============================================
# PUBLIC URLs
# =============================================
PUBLIC_BASE_URL=https://api.athyper.com
PUBLIC_WEB_URL=https://neon.athyper.com

# =============================================
# BASE PATHS
# =============================================
MESH_DATA=/var/lib/athyper/mesh/data
MESH_CONFIG=/etc/athyper/mesh/config
ATHYPER_KERNEL_CONFIG_PATH=apps/athyper/kernel.config.production.parameter.json
AUTH_DEBUG_EXPOSE_TOKENS=false
# =============================================
# HOSTNAMES
# =============================================
# Gateway & Infrastructure
GATEWAY_HOST=gateway.mesh.athyper.com
IAM_HOST=iam.mesh.athyper.com
OBJECTSTORAGE_HOST=objectstorage.mesh.athyper.com
OBJECTSTORAGE_CONSOLE_HOST=objectstorage.console.mesh.athyper.com

# Observability
TELEMETRY_HOST=telemetry.mesh.athyper.com
METRICS_HOST=metrics.mesh.athyper.com
TRACES_HOST=traces.mesh.athyper.com
LOGS_HOST=logs.mesh.athyper.com

# Applications
APPS_ATHYPER_WEB_HOST=neon.athyper.com
APPS_ATHYPER_API_HOST=api.athyper.com

# =============================================
# GATEWAY (Traefik)
# =============================================
GATEWAY_TLS_OPTIONS=mesh-gateway-tls12@file
DASHBOARD_AUTH_MW=mesh-dashboard-auth@file
GATEWAY_ACCESSLOG=false
GATEWAY_LOG_LEVEL=WARN

# =============================================
# SERVICE MEMORY LIMITS
# =============================================
GATEWAY_MEMORY_LIMIT=512m
IAM_MEMORY_LIMIT=2g
OBJECTSTORAGE_MEMORY_LIMIT=1g
MEMORYCACHE_MEMORY_LIMIT=512m
MEMORYCACHE_EXPORTER_MEMORY_LIMIT=128m
TELEMETRY_MEMORY_LIMIT=1g
METRICS_MEMORY_LIMIT=1g
TRACING_MEMORY_LIMIT=1g
LOGGING_MEMORY_LIMIT=1g
LOGSHIPPER_MEMORY_LIMIT=256m
APPS_ATHYPER_MEMORY_LIMIT=1g

# =============================================
# DATABASE (PostgreSQL via PgBouncer)
# =============================================
DATABASE_URL=${DATABASE_URL}
DATABASE_ADMIN_URL=${DATABASE_ADMIN_URL}
DB_POOL_MAX=50

# =============================================
# CACHE (Redis)
# =============================================
REDIS_URL=${REDIS_URL}
MEMORYCACHE_PASSWORD=${REDIS_PASSWORD}

# =============================================
# OBJECT STORAGE (MinIO S3)
# S3_ACCESS_KEY/S3_SECRET_KEY are also used as
# MinIO root credentials in the objectstorage container
# =============================================
S3_ENDPOINT=${S3_ENDPOINT}
S3_ACCESS_KEY=${S3_ACCESS_KEY}
S3_SECRET_KEY=${S3_SECRET_KEY}
S3_REGION=${S3_REGION}
S3_BUCKET=${S3_BUCKET}
S3_USE_SSL=true

# =============================================
# IAM (Keycloak)
# =============================================
IAM_ADMIN=${IAM_ADMIN_USER}
IAM_ADMIN_PASSWORD=${IAM_ADMIN_PASSWORD}
IAM_DB_URL=${IAM_DB_URL}
IAM_DB_USERNAME=${IAM_DB_USERNAME}
IAM_DB_PASSWORD=${IAM_DB_PASSWORD}
IAM_ISSUER_URL=${IAM_ISSUER_URL}
IAM_CLIENT_ID=${IAM_CLIENT_ID}
IAM_CLIENT_SECRET=${IAM_CLIENT_SECRET}

# =============================================
# IAM SECRETS (SUPERSTAR env vars)
# =============================================
# These are resolved by kernel config loader
ATHYPER_SUPER__IAM_SECRET__IAM_ATHYPER_CLIENT_SECRET=${IAM_CLIENT_SECRET}

# =============================================
# TELEMETRY
# =============================================
OTLP_ENDPOINT=${OTLP_ENDPOINT}
TELEMETRY_ADMIN_USER=${GRAFANA_ADMIN_USER}
TELEMETRY_ADMIN_PASSWORD=${GRAFANA_ADMIN_PASSWORD}
